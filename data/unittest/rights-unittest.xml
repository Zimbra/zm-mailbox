<?xml version="1.0" encoding="UTF-8"?>

<rights>

<include file="zimbra-rights.xml"/>

<!-- 
========================================================
                 for unittest only
========================================================
-->

<!--  
      =============
      user rights 
      =============
-->

<right name="test-user" userRight="1">
  <desc>a user right</desc>
</right>

<!--  
      =============
      preset rights 
      =============
-->
<right name="test-preset-account" type="preset" targetType="account">
  <desc>a preset account right</desc>
</right>

<right name="test-preset-calendarresource" type="preset" targetType="calresource">
  <desc>a preset calendar resource right</desc>
</right>

<right name="test-preset-globalconfig" type="preset" targetType="config">
  <desc>a preset global config right</desc>
</right>

<right name="test-preset-cos" type="preset" targetType="cos">
  <desc>a preset cos right</desc>
</right>

<right name="test-preset-distributionlist" type="preset" targetType="dl">
  <desc>a preset distribution list right</desc>
</right>

<right name="test-preset-domain" type="preset" targetType="domain">
  <desc>a preset domain right</desc>
</right>

<right name="test-preset-globalgrant" type="preset" targetType="global">
  <desc>a preset global grant right</desc>
</right>

<right name="test-preset-server" type="preset" targetType="server">
  <desc>a preset server right</desc>
</right>

<right name="test-preset-xmppcomponent" type="preset" targetType="xmppcomponent">
  <desc>a preset xmppcomponent right</desc>
</right>

<right name="test-preset-zimlet" type="preset" targetType="zimlet">
  <desc>a preset zimlet right</desc>
</right>


<!--  
      ==================
      getAttrs rights 
      
      single target type
      ==================
-->
<right name="test-getAttrs-account" type="getAttrs" targetType="account">
  <desc>a getAttrs account right</desc>
  <attrs>
      <a n="description"/>
      <a n="zimbraMailStatus"/>
      <a n="zimbraMailQuota"/>
      <a n="zimbraQuotaWarnPercent"/>
      <a n="zimbraQuotaWarnInterval"/>
      <a n="zimbraQuotaWarnMessage"/>
      <a n="displayName"/>
  </attrs>
</right>

<right name="test-getAttrs-calendarresource" type="getAttrs" targetType="calresource">
  <desc>a getAttrs calendar resource right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-getAttrs-globalconfig" type="getAttrs" targetType="config">
  <desc>a getAttrs global config right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-getAttrs-cos" type="getAttrs" targetType="cos">
  <desc>a getAttrs cos right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-getAttrs-distributionlist" type="getAttrs" targetType="dl">
  <desc>a getAttrs distribution list right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-getAttrs-domain" type="getAttrs" targetType="domain">
  <desc>a getAttrs domain right</desc>
  <attrs>
      <a n="description"/>
      <a n="zimbraMailStatus"/>
      <a n="zimbraGalMode"/>
  </attrs>
</right>

<right name="test-getAttrs-globalgrant" type="getAttrs" targetType="global">
  <desc>a getAttrs global grant right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-getAttrs-server" type="getAttrs" targetType="server">
  <desc>a getAttrs server right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-getAttrs-zimlet" type="getAttrs" targetType="zimlet">
  <desc>a getAttrs zimlet right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>


<!--  
      ====================
      getAttrs rights 
      
      multiple target type
      ====================
-->
<right name="test-getAttrs-accountCos" type="getAttrs" targetType="account,cos">
  <desc>a getAttrs account right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-getAttrs-accountDomain" type="getAttrs" targetType="account,domain">
  <desc>a getAttrs account right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<!--  
      ==================
      setAttrs rights 
      
      single target type
      ==================
-->
<right name="test-setAttrs-account" type="setAttrs" targetType="account">
  <desc>a setAttrs account right</desc>
  <attrs>
      <a n="description"/>
      <a n="zimbraMailStatus"/>
      <a n="zimbraMailQuota"/>
      <a n="zimbraQuotaWarnPercent"/>
      <a n="zimbraQuotaWarnInterval"/>
      <a n="zimbraQuotaWarnMessage"/>
      <a n="displayName"/>
  </attrs>
</right>

<right name="test-setAttrs-calendarresource" type="setAttrs" targetType="calresource">
  <desc>a setAttrs calendar resource right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-setAttrs-globalconfig" type="setAttrs" targetType="config">
  <desc>a setAttrs global config right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-setAttrs-cos" type="setAttrs" targetType="cos">
  <desc>a setAttrs cos right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-setAttrs-distributionlist" type="setAttrs" targetType="dl">
  <desc>a setAttrs distribution list right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-setAttrs-domain" type="setAttrs" targetType="domain">
  <desc>a setAttrs domain right</desc>
  <attrs>
      <a n="description"/>
      <a n="zimbraGalMode"/>
  </attrs>
</right>

<right name="test-setAttrs-globalgrant" type="setAttrs" targetType="global">
  <desc>a setAttrs global grant right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-setAttrs-server" type="setAttrs" targetType="server">
  <desc>a setAttrs server right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-setAttrs-zimlet" type="setAttrs" targetType="zimlet">
  <desc>a setAttrs zimlet right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<!--  
      ====================
      setAttrs rights 
      
      multiple target type
      ====================
-->
<right name="test-setAttrs-accountCos" type="setAttrs" targetType="account,cos">
  <desc>a setAttrs account right</desc>
  <attrs>
      <a n="description"/>
  </attrs>
</right>

<right name="test-setAttrs-accountDomain" type="setAttrs" targetType="account,domain">
  <desc>a setAttrs account right</desc>
  <attrs>
      <a n="description"/>
      <a n="zimbraMailStatus"/>
  </attrs>
</right>

<!--  
      ==================
      combo rights
      ==================
-->
<right name="test-combo-account" type="combo">
  <desc>a combo right that has only account rights</desc>
  <rights>
    <r n="test-preset-account"/>
    <r n="test-getAttrs-account"/>
    <r n="test-setAttrs-account"/>
  </rights>
</right>

<right name="test-combo-account-cos-accountCos" type="combo">
  <desc>a combo right that has account, cos, account/cos rights</desc>
  <rights>
    <r n="test-preset-account"/>
    <r n="test-preset-cos"/>
    <r n="test-getAttrs-accountCos"/>
    <r n="test-setAttrs-accountCos"/>
  </rights>
</right>

<right name="test-combo-account-domain" type="combo">
  <desc>a combo right that has account, domain rights</desc>
  <rights>
    <r n="test-combo-account"/>
    <r n="test-preset-domain"/>
    <r n="test-setAttrs-distributionlist"/>
    <r n="test-setAttrs-accountDomain"/>
    <r n="test-setAttrs-domain"/>
  </rights>
</right>

<!--  
      ==================
      combo rights (to clean up)
      ==================
-->

<right name="test-getAttrs-account-2" type="getAttrs" targetType="account,cos">
  <desc>for unittest only, do we have a use case for this?</desc>
  <attrs>
      <a n="zimbraMailQuota"/>
      <a n="zimbraQuotaWarnPercent"/>
      <a n="zimbraQuotaWarnInterval"/>
      <a n="zimbraQuotaWarnMessage"/>
  </attrs>
</right>

<right name="test-setAttrs-account-1" type="setAttrs" targetType="account">
  <desc>modify some account attrs</desc>
  <attrs>
    <a n="displayName"/>
    <a n="description"/>
  </attrs>
</right>

<right name="test-setAttrs-account-2" type="setAttrs" targetType="account">
  <desc>modify some account attrs</desc>
  <attrs>
      <a n="zimbraMailQuota"/>
      <a n="zimbraQuotaWarnPercent"/>
      <a n="zimbraQuotaWarnInterval"/>
      <a n="zimbraQuotaWarnMessage"/>
  </attrs>
</right>

<right name="test-combo-MultiTargetTypes-sub" type="combo">
  <desc>a combo right that spans multiple target types</desc>
  <rights>
    <r n="test-preset-domain"/>
    <r n="test-preset-account"/>
    <r n="test-setAttrs-account-2"/>
    <r n="test-setAttrs-domain"/>
  </rights>
</right>

<right name="test-combo-MultiTargetTypes-top" type="combo">
  <desc>a combo right that spans multiple target types</desc>
  <rights>
    <r n="test-combo-MultiTargetTypes-sub"/>
    <r n="test-setAttrs-account-1"/>
    <r n="test-setAttrs-accountDomain"/>
  </rights>
</right>

</rights>